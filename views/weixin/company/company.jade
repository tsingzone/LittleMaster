//
   Created by michel_feng on 15/10/21.

extends ../layout
block header-back
    img#dingwei(src='/images/dingwei.png')
    | 北京市
block header-title
    | 找兼职
block content
    #screening
        span#type
            .text 类型
            .dropDown
            .vertical
        span#area
            .text 地区
            .dropDown
            .vertical
        span#time
            .text 时间
            .dropDown
            .vertical
        span#sort
            .text 排序
            .dropDown
    #job_list
        .job
            .job_type 批改
            .job_content
                .job_time 工作日期: 09/14-09/30
                .job_title 招小学作文批改兼职老师招小学作文批改兼职老师招小学作文批改兼职老师
                .job_others 网络 不限性别 月结
                    .job_price 150元/天
    #list
    #calendar
    #mask_job


block script
    script.
        var checked = false;
        $(function() {
            $('#find_job').addClass('current');
            if(sessionStorage.getItem('cityCode')) {
                $("#header-back").html("<img id='dingwei' src='/images/dingwei.png'/>" + sessionStorage.getItem('city'));
                $("#header-back,#header-title,#header-save").css("width","33%");
            } else {
                sessionStorage.setItem('city', "北京市");
                sessionStorage.setItem('cityCode', 110100);
            }
            new Kalendae(document.getElementById("calendar"), {
                months:1,
                mode:'multiple'
            });
        });
        $("#header-back,#screening span").click(function() {
            if($(".cur").attr("id") != $(this).attr("id")) {
                checked = false;
                $("#list").hide();
                $("#mask_job").hide();
                $("#calendar").hide();
            }
            if (checked) {
                $("#mask_job").hide();
                $("#list").hide();
                $("#calendar").hide();
                $("#screening span").removeClass("cur");
                checked = false;
            } else {
                var item = $(this).attr("id");
                if(item == "header-back") {
                    location.href = "company/city";
                } else {
                    $("#mask_job").show();
                    $("#screening span").removeClass("cur");
                    $(this).addClass("cur");
                    switch (item) {
                        case "time":
                            $("#calendar").css("left",($(window).width() - $("#calendar").width())/2 + 'px');
                            $("#calendar").css("top",($(window).height() - $("#calendar").height())/2 + 'px');
                            $("#calendar").show();
                            break;
                        case "sort":
                            var str = "";
                            str += "<div class='list'>最新发布</div>"
                                + "<div class='list'>高价优先</div>"
                                + "<div class='list'>离我最近</div>"
                                + "<div class='list'>日结优先</div>"
                                + "<div class='list'>周末优先</div>";
                            $("#list").html(str);
                            $("#list").show();
                            $(document).on("click",".list",function() {
                                $(".list").removeClass("cur");
                                $(this).addClass("cur");
                            });
                            break;
                        case "type":
                            $.ajax({
                                url:"/weixin/company/type",
                                type:"get",
                                dataType:"json",
                                success:function(lists) {
                                    var str = "";
                                    for(var i = 0;i < lists.length;i++) {
                                        str += "<div class='list' typeId='" + lists[i]["id"] + "' >" + lists[i]["name"] + "</div>";
                                    }
                                    $("#list").html(str);
                                }
                            });
                            $("#list").show();
                            $(document).on("click",".list",function() {
                                $(".list").removeClass("cur");
                                $(this).addClass("cur");
                            });
                            break;
                        case "area":
                            var cityCode = sessionStorage.getItem('cityCode');
                            $.ajax({
                                url:"/weixin/company/area",
                                type:"get",
                                dataType:"json",
                                data:"cityCode=" + cityCode,
                                success:function(lists) {
                                    var str = "";
                                    for(var i = 0;i < lists.length;i++) {
                                        str += "<div class='list' areaId='" + lists[i]["id"] + "' >" + lists[i]["area"] + "</div>";
                                    }
                                    $("#list").html(str);
                                }
                            });
                            $("#list").show();
                            $(document).on("click",".list",function() {
                                $(".list").removeClass("cur");
                                $(this).addClass("cur");
                            });
                            break;
                    }
                }
                checked = true;
            }
        });
        $("#mask_job").click(function() {
            $(this).hide();
            $("#list").hide();
            $("#calendar").hide();
            $("#screening span").removeClass("cur");
            checked = false;
        });
        $(".list").click(function() {
            var city = $("#header-back").html();
            var type = $("#type").html();
            var area = $("#area").html();
            var time = $("#time").html();
            var sort = $("#sort").html();

        });
        $(document).on("click",".job",function() {
            location.href = "company/profile";
        });
